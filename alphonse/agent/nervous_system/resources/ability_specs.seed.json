[
  {
    "intent_name": "core.location.current",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [
      {
        "name": "label",
        "type": "location_label",
        "description": "Location label (home, work, other)",
        "required": false,
        "order": 1
      }
    ],
    "prompts": {
      "label": "core.location.current.ask_label"
    },
    "step_sequence": [
      {
        "order": 1,
        "action": "location.current",
        "input": ["label"]
      }
    ],
    "outputs": {
      "success": "core.location.current"
    }
  },
  {
    "intent_name": "core.location.set",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [
      {
        "name": "label",
        "type": "location_label",
        "description": "Location label (home, work, other)",
        "required": true,
        "order": 1
      },
      {
        "name": "address_text",
        "type": "address_text",
        "description": "Address to store",
        "required": true,
        "order": 2
      }
    ],
    "prompts": {
      "label": "core.location.set.ask_label",
      "address_text": "core.location.set.ask_address"
    },
    "step_sequence": [
      {
        "order": 1,
        "action": "location.set",
        "input": ["label", "address_text"]
      }
    ],
    "outputs": {
      "success": "core.location.set.completed"
    }
  },
  {
    "intent_name": "core.users.list",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [],
    "step_sequence": [
      {
        "order": 1,
        "action": "users.list",
        "input": []
      }
    ],
    "outputs": {
      "success": "core.users.list.completed"
    }
  },
  {
    "intent_name": "greeting",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [],
    "step_sequence": [
      {
        "order": 1,
        "action": "greeting",
        "input": []
      }
    ],
    "outputs": {
      "success": "core.greeting"
    }
  },
  {
    "intent_name": "help",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [],
    "step_sequence": [
      {
        "order": 1,
        "action": "help",
        "input": []
      }
    ],
    "outputs": {
      "success": "help"
    }
  },
  {
    "intent_name": "get_status",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [],
    "step_sequence": [
      {
        "order": 1,
        "action": "status",
        "input": []
      }
    ],
    "outputs": {
      "success": "status"
    }
  },
  {
    "intent_name": "meta.capabilities",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [],
    "step_sequence": [
      {
        "order": 1,
        "action": "meta.capabilities",
        "input": []
      }
    ],
    "outputs": {
      "success": "meta.capabilities"
    }
  },
  {
    "intent_name": "update_preferences",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [],
    "step_sequence": [
      {
        "order": 1,
        "action": "update_preferences",
        "input": []
      }
    ],
    "outputs": {
      "success": "ack.preference_updated"
    }
  },
  {
    "intent_name": "cancel",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [],
    "step_sequence": [
      {
        "order": 1,
        "action": "cancel",
        "input": []
      }
    ],
    "outputs": {
      "success": "ack.cancelled"
    }
  },
  {
    "intent_name": "time.current",
    "kind": "tool_call_then_response",
    "tools": ["clock"],
    "tool_call": {
      "tool": "clock",
      "method": "current_time",
      "args": {
        "timezone_name": "{timezone}"
      }
    },
    "responses": {
      "es": "Son las {tool_output.time} en {tool_output.timezone}.",
      "default": "It is {tool_output.time} in {tool_output.timezone}."
    }
  },
  {
    "intent_name": "meta.gaps_list",
    "kind": "plan_emit",
    "tools": [],
    "plan": {
      "plan_type": "QUERY_STATUS",
      "target_from": ["channel_target", "chat_id"],
      "channels_from": ["channel_type"],
      "payload": {
        "include": ["gaps_summary"],
        "limit": 5,
        "locale": "{locale}"
      }
    }
  },
  {
    "intent_name": "core.onboarding.start",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [
      {
        "name": "user_name",
        "type": "person_name",
        "description": "Name of the primary admin user",
        "required": true,
        "order": 1
      }
    ],
    "prompts": {
      "user_name": "core.onboarding.primary.ask_name"
    },
    "step_sequence": [
      {
        "order": 1,
        "action": "identity.set_display_name",
        "input": ["user_name"]
      },
      {
        "order": 2,
        "action": "users.upsert_admin",
        "input": ["user_name"]
      },
      {
        "order": 3,
        "action": "onboarding.mark_primary_complete"
      }
    ],
    "outputs": {
      "success": "ack.user_name"
    }
  },
  {
    "intent_name": "core.onboarding.add_user",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [
      {
        "name": "display_name",
        "type": "person_name",
        "description": "Name of the new user",
        "required": true,
        "order": 1
      },
      {
        "name": "relationship",
        "type": "relationship",
        "description": "Relationship to the admin",
        "required": true,
        "order": 2
      },
      {
        "name": "role",
        "type": "role",
        "description": "Household role",
        "required": false,
        "order": 3
      },
      {
        "name": "channel_provider",
        "type": "channel_provider",
        "description": "Channel provider (telegram, discord, etc)",
        "required": true,
        "order": 4
      }
    ],
    "prompts": {
      "display_name": "core.onboarding.secondary.ask_name",
      "relationship": "core.onboarding.secondary.ask_relationship",
      "role": "core.onboarding.secondary.ask_role",
      "channel_provider": "core.onboarding.authorize.ask_channel_type"
    },
    "step_sequence": [
      {
        "order": 1,
        "action": "users.upsert_secondary",
        "input": ["display_name", "relationship", "role"]
      }
    ],
    "outputs": {
      "success": "core.onboarding.secondary.completed"
    }
  },
  {
    "intent_name": "core.onboarding.authorize_channel",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [
      {
        "name": "display_name",
        "type": "person_name",
        "description": "Name of the user to authorize",
        "required": true,
        "order": 1
      },
      {
        "name": "channel_provider",
        "type": "channel_provider",
        "description": "Channel provider (telegram, discord, etc)",
        "required": true,
        "order": 2,
        "default": "telegram"
      },
      {
        "name": "channel_address",
        "type": "channel_address",
        "description": "Channel address or chat id",
        "required": true,
        "order": 3
      }
    ],
    "prompts": {
      "display_name": "core.onboarding.authorize.ask_user",
      "channel_provider": "core.onboarding.authorize.ask_channel_type",
      "channel_address": "core.onboarding.authorize.ask_channel_address"
    },
    "step_sequence": [
      {
        "order": 1,
        "action": "channels.authorize",
        "input": ["display_name", "channel_provider", "channel_address"]
      }
    ],
    "outputs": {
      "success": "core.onboarding.authorize.completed"
    }
  },
  {
    "intent_name": "core.onboarding.introduce_authorize",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [
      {
        "name": "display_name",
        "type": "person_name",
        "description": "Name of the new user",
        "required": true,
        "order": 1
      },
      {
        "name": "relationship",
        "type": "relationship",
        "description": "Relationship to the admin",
        "required": true,
        "order": 2
      },
      {
        "name": "role",
        "type": "role",
        "description": "Household role",
        "required": false,
        "order": 3
      },
      {
        "name": "channel_provider",
        "type": "channel_provider",
        "description": "Channel provider (telegram, discord, etc)",
        "required": true,
        "order": 4,
        "default": "telegram"
      },
      {
        "name": "channel_address",
        "type": "channel_address",
        "description": "Channel address or chat id",
        "required": true,
        "order": 5
      }
    ],
    "prompts": {
      "display_name": "core.onboarding.secondary.ask_name",
      "relationship": "core.onboarding.secondary.ask_relationship",
      "role": "core.onboarding.secondary.ask_role",
      "channel_provider": "core.onboarding.authorize.ask_channel_type",
      "channel_address": "core.onboarding.authorize.ask_channel_address"
    },
    "step_sequence": [
      {
        "order": 1,
        "action": "users.upsert_secondary",
        "input": ["display_name", "relationship", "role"]
      },
      {
        "order": 2,
        "action": "channels.authorize",
        "input": ["display_name", "channel_provider", "channel_address"]
      }
    ],
    "outputs": {
      "success": "core.onboarding.introduce_authorize.completed"
    }
  },
  {
    "intent_name": "core.identity.query_user_name",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [
      {
        "name": "user_name",
        "type": "person_name",
        "description": "Name of the current user",
        "required": true,
        "order": 1
      }
    ],
    "prompts": {
      "user_name": "core.identity.user.ask_name"
    },
    "step_sequence": [
      {
        "order": 1,
        "action": "identity.set_display_name",
        "input": ["user_name"]
      }
    ],
    "outputs": {
      "success": "core.identity.user.known"
    }
  },
  {
    "intent_name": "core.identity.query_agent_name",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [],
    "step_sequence": [
      {
        "order": 1,
        "action": "identity.agent",
        "input": []
      }
    ],
    "outputs": {
      "success": "core.identity.agent"
    }
  },
  {
    "intent_name": "onboarding.location.set_home",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [
      {
        "name": "label",
        "type": "location_label",
        "description": "Location label (home, work, other)",
        "required": false,
        "order": 1,
        "default": "home"
      },
      {
        "name": "address_text",
        "type": "address_text",
        "description": "Address to store",
        "required": true,
        "order": 2
      }
    ],
    "prompts": {
      "address_text": "core.location.set.ask_address"
    },
    "step_sequence": [
      {
        "order": 1,
        "action": "location.set_geocode",
        "input": ["label", "address_text"]
      }
    ],
    "outputs": {
      "success": "ack.location.saved"
    }
  },
  {
    "intent_name": "onboarding.location.set_work",
    "kind": "ability_flow",
    "tools": [],
    "input_parameters": [
      {
        "name": "label",
        "type": "location_label",
        "description": "Location label (home, work, other)",
        "required": false,
        "order": 1,
        "default": "work"
      },
      {
        "name": "address_text",
        "type": "address_text",
        "description": "Address to store",
        "required": true,
        "order": 2
      }
    ],
    "prompts": {
      "address_text": "core.location.set.ask_address"
    },
    "step_sequence": [
      {
        "order": 1,
        "action": "location.set_geocode",
        "input": ["label", "address_text"]
      }
    ],
    "outputs": {
      "success": "ack.location.saved"
    }
  }
]
