{% extends "base.html" %}

{% block title %}Family — Atrium{% endblock %}

{% block content %}
  <main class="app-shell">
    {% include "partials/top_nav.html" %}
    <div class="shell-body">
      {% include "partials/sidebar_nav.html" %}
      <section class="content">
        <div class="section-header">
          <div class="subtitle">Family directory</div>
        </div>

        <section class="panel" id="family-list">
          <h2>Family List</h2>
          {% if members %}
            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Role</th>
                    <th>Birthday</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  {% for member in members %}
                    <tr>
                      <td>{{ member.name }}</td>
                      <td>{{ member.role }}</td>
                      <td>{{ member.birthday or "—" }}</td>
                      <td>
                        <a class="nav-link" href="/family?edit_id={{ member.id }}">Edit</a>
                      </td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% else %}
            <p class="status-message">No family members yet.</p>
          {% endif %}
        </section>

        <section class="panel" id="edit-member">
          <h2>Edit Member</h2>
          {% if edit_member %}
            <form class="form-grid" method="post" action="/family/{{ edit_member.id }}">
              <label>
                Name
                <input type="text" name="name" value="{{ edit_member.name or '' }}" required>
              </label>
              <label>
                Role
                <input type="text" name="role" value="{{ edit_member.role or '' }}" required>
              </label>
              <label>
                Birthday
                <input type="date" name="birthday" value="{{ format_date_local(edit_member.birthday) }}">
              </label>
              <div class="form-actions form-full">
                <button type="submit">Save changes</button>
              </div>
            </form>
          {% else %}
            <p class="status-message">Select a member from the table to edit.</p>
          {% endif %}
        </section>

        <section class="panel" id="create-member">
          <h2>Create Member</h2>
          <form class="form-grid" method="post" action="/family">
            <label>
              Name
              <input type="text" name="name" required>
            </label>
            <label>
              Role
              <input type="text" name="role" required>
            </label>
            <label>
              Birthday
              <input type="date" name="birthday">
            </label>
            <div class="form-actions form-full">
              <button type="submit">Create member</button>
            </div>
          </form>
        </section>
      </section>
    </div>
  </main>
{% endblock %}
