{% extends "base.html" %}

{% block title %}Timed Signals — Atrium{% endblock %}

{% block content %}
  <main class="app-shell">
    {% include "partials/top_nav.html" %}
    <div class="shell-body">
      {% include "partials/sidebar_nav.html" %}
      <section class="content">
        <div class="section-header">
          <div class="subtitle">Scheduled signals</div>
        </div>

        <section class="panel" id="timed-signals">
          <h2>Timed Signals</h2>
          {% if timed_signals %}
            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>Signal Type</th>
                    <th>Trigger</th>
                    <th>Next Trigger</th>
                    <th>Status</th>
                    <th>Target</th>
                    <th>Origin</th>
                  </tr>
                </thead>
                <tbody>
                  {% for signal in timed_signals %}
                    <tr>
                      <td>{{ signal.signal_type }}</td>
                      <td>{{ signal.trigger_at }}</td>
                      <td>{{ signal.next_trigger_at or "—" }}</td>
                      <td>{{ signal.status }}</td>
                      <td>{{ signal.target or "—" }}</td>
                      <td>{{ signal.origin or "—" }}</td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% else %}
            <p class="status-message">No timed signals scheduled yet.</p>
          {% endif %}
        </section>

        <section class="panel" id="create-timed-signal">
          <h2>Create Timed Signal</h2>
          <form class="form-grid" method="post" action="/timed-signals">
            <label>
              Signal type
              <select name="signal_type" required>
                <option value="reminder">reminder</option>
                <option value="execute">execute</option>
                <option value="routine">routine</option>
                <option value="custom" selected>custom</option>
              </select>
            </label>
            <label>
              Trigger at
              <input type="datetime-local" name="trigger_at" required>
            </label>
            <label>
              RRULE (optional)
              <input type="text" name="rrule" placeholder="RRULE:FREQ=DAILY;COUNT=5">
            </label>
            <label>
              Timezone
              <input type="text" name="timezone" placeholder="America/Mexico_City">
            </label>
            <label>
              Target
              <input type="text" name="target" placeholder="alex">
            </label>
            <label>
              Origin
              <input type="text" name="origin" value="webui">
            </label>
            <label>
              Correlation ID
              <input type="text" name="correlation_id">
            </label>
            <label class="form-full">
              Payload (JSON)
              <textarea name="payload" rows="4">{}</textarea>
            </label>
            <div class="form-actions form-full">
              <button type="submit">Schedule signal</button>
            </div>
          </form>
        </section>
      </section>
    </div>
  </main>
{% endblock %}
