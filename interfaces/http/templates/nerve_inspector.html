{% extends "base.html" %}

{% block title %}FSM Inspector — Nerve DB{% endblock %}

{% block content %}
  <main class="app-shell">
    {% include "partials/top_nav.html" %}
    <div class="shell-body">
      {% include "partials/sidebar_nav.html" %}
      <section class="content">
        <div class="section-header">
          <div class="subtitle">FSM Inspector</div>
        </div>

        <section class="panel" id="inspector-form">
          <h2>Resolve Transition</h2>
          <form class="form-grid" method="post" action="/nerve/inspector">
            <label>
              State
              <select name="state_id" required>
                <option value="" disabled selected>Select state</option>
                {% for state in states %}
                  <option value="{{ state.id }}">{{ state.key }} ({{ state.name }})</option>
                {% endfor %}
              </select>
            </label>
            <label>
              Signal
              <select name="signal_id" required>
                <option value="" disabled selected>Select signal</option>
                {% for signal in signals %}
                  <option value="{{ signal.id }}">{{ signal.key }} ({{ signal.name }})</option>
                {% endfor %}
              </select>
            </label>
            <div class="form-actions form-full">
              <button type="submit">Resolve</button>
            </div>
          </form>
        </section>

        <section class="panel" id="inspector-result">
          <h2>Resolved Transition</h2>
          {% if resolved %}
            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>Transition</th>
                    <th>State</th>
                    <th>Signal</th>
                    <th>Next State</th>
                    <th>Action</th>
                    <th>Guard</th>
                    <th>Priority</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>{{ resolved.id }}</td>
                    <td>{{ resolved.state_key }}</td>
                    <td>{{ resolved.signal_key }}</td>
                    <td>{{ resolved.next_state_key }}</td>
                    <td>{{ resolved.action_key or "—" }}</td>
                    <td>{{ resolved.guard_key or "—" }}</td>
                    <td>{{ resolved.priority }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          {% else %}
            <p class="status-message">No transition matched.</p>
          {% endif %}
        </section>
      </section>
    </div>
  </main>
{% endblock %}
